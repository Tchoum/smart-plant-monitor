<html>
  <head>
    <link href="style.css" rel="stylesheet" type="text/css">
    <title>SMART PLANT SETTINGS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
  </head>
  <body>
  <canvas id="canvas"></canvas>
    <div>
    <form action="/settings" method="POST">
      <a href="/">HOME</a> | <a href="/wifi">WIFI</a> | <a href="/config">CONFIG HA</a>
      <br /><a href="/jeedom">CONFIG JEEDOM</a> | <a href="/sensors">SENSORS</a>
      <br><a href="/settings">SETTINGS</a> | <a href="/firmware">FIRMWARE</a>
      <h1>SETTINGS</h1>
      <br>
      <b>
        <label for="update_interval">Update Interval: <span id="value"></span> min</label>
        <br>
      </b>
      <input type="range" min="1" max="120" value="%update_interval_default%" class="slider" id="update_interval" name="update_interval" required>
      <br><br>
      <b>
        <label for="soil_humidity_max">Soil Humidity Max:</label>
        <br>
      </b>
      <input type="text" name="soil_humidity_max" value="%soil_humidity_max%" required>
      <br><br>
      <b>
        <label for="arrosage_semaine">Arrosage semaine (0=Désactivé):</label>
        <br>
      </b>
      <input type="number" name="arrosage_semaine" value="%arrosage_semaine%" >
      <br><br>
      <b>
        <label for="timezone">Time zone:</label>
        <br>
      </b>
      <select id="timezone" name="timezone">
        <option value="">-</option>
      </select>
      <script type="text/javascript">
        timezone = "%timezone%"
        let dropdown = document.getElementById('timezone');
        dropdown.length = 0;

        const url = 'zone.json';

        fetch(url)
        .then(
          function(response) {
            response.json().then(function(data) {
              let option;
              const text = Object.keys(data);
              const value = Object.values(data)
              for (let i = 0; i < text.length; i++) {
                option = document.createElement('option');
                option.text = text[i];
                option.value = value[i];
                if (timezone == value[i]) {
                  option.selected = true;
                }
                dropdown.add(option);
              }
          })

        });
      </script>
      <br><br>
      <input class="btn" type="submit" value="Submit">
      <br>
    </form>
	</div>
    <script type="text/javascript" src="script.js"></script>
	<script>
	var slider = document.getElementById("update_interval");
	var output = document.getElementById("value");
	output.innerHTML = slider.value;

	slider.oninput = function() {
	  output.innerHTML = this.value;
	}
	</script>
  </body>
</html>
